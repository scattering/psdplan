{% extends "base.html" %}
{% block title %}Neutron Activation Calculator{% endblock %}
{% block head  %}
<link rel="stylesheet" type="text/css" href="/static/lib/ext/resources/css/ext-all.css" />
    <link rel="stylesheet" type="text/css" href="/static/lib/ext/examples/shared/example.css" />
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/start/jquery-ui.css" type="text/css" rel="Stylesheet" />

    <!--[if lt IE 9]><script language="javascript" type="text/javascript" src="excanvas.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js" type="text/javascript"></script>

    <script type="text/javascript" src="/static/lib/ext/bootstrap.js"></script>
    <script type="text/javascript" src="/static/lib/ajaxCSRFfix.js"></script>





    <script type="text/javascript" src="/static/lib/plotting/jqplot/jquery.jqplot.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.canvasTextRenderer.min.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.canvasAxisLabelRenderer.min.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.canvasAxisTickRenderer.min.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.errorbarRenderer.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.logAxisRenderer.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.cursor.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/jqplot.FixedAspect.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/jquery.jqplot.InteractiveLegend.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/jqplot/plugins/jqplot.mobile.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/palettes.js"></script>
    <!--<script type="text/javascript" src="/static/lib/plotting/tas_plotting_api.js"></script>-->
    <script type="text/javascript" src="/static/lib/plotting/plotting_api.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/heatmapRenderer.js"></script>
    <script type="text/javascript" src="/static/lib/plotting/colorbarRenderer.js"></script>
    <script type="text/javascript" src="/static/lib/interactors/interactors_nonprototype.js"></script>
    <script type="text/javascript" src="/static/lib/interactors/interactor_plugin_base.js"></script>
<script type="text/javascript">
$(document).ready(function() {
$("#id-activationForm").submit(function(event){
event.preventDefault();
$.ajax({
type:"POST",
url:"/activation/",
data: {chemical_formula: $('input:text[id=id_chemical_formula]').val(),
       flux: $('input:text[id=id_flux]').val(),
       mass: $('input:text[id=id_mass]').val(),
       time_on: $('input:text[id=id_time_on]').val(),
       time_off: $('input:text[id=id_time_off]').val()
},
success: function(ldata){
console.log(ldata);
    var result={"sample": "H2O",
        "flux": 100000.0,
        "total": [1.7392087984473418e-06, 1.3956412267781634e-13, 1.3955889378618731e-13, 1.3948351060971843e-13],
        "mass": 1.0, "rest": [0.0, 1.0, 24.0, 360.0],
        "activity": [["H-2", "H-3", "act", "12.346 y", 3.483063328044691e-14, 3.483041009656089e-14, 3.482527726186947e-14, 3.4750379423468825e-14],
            ["O-16", "N-16", "n,p", "7.14 s", 1.7125399929855225e-06, 3.0620613990759853e-158, 0.0, 0.0],
            ["O-16", "O-15", "n,2n", "122 s", 4.777085237307763e-11, 6.283430904318814e-20, 3.435385428075529e-224, 0.0],
            ["O-17", "C-14", "n,a", "5736 y", 1.0473365119140876e-13, 1.0473364974694641e-13, 1.0473361652431783e-13, 1.0473313118624961e-13],
            ["O-17", "N-17", "n,p", "4.17 s", 2.7790531348212377e-10, 4.139938733834401e-270, 0.0, 0.0],
            ["O-18", "O-19", "act", "27.1 s", 2.634298973167962e-08, 2.753803230750374e-48, 0.0, 0.0]],
        "exposure": 1.0, "fast": 0.0, "Cd": 0.0};
    var result=$.parseJSON(ldata);
    result.total.splice(0,0,"total activity","","",""); //for a final column
    result.activity.push(result.total);
    var data={}
    //construct headers
    data.headers=["element","daughter","reaction","half life","activity (0 hrs)","activity ( 1hr)", "activity (24 hrs)", "activity (15 days)", result.rest[4]+" (hours)"]
    data.rows=[]
    for (var i=0; i < result.activity.length; i++){
        data.rows.push(result.activity[i]);
    }

    //add headers to table
    var row = '<tr class="header">';
    for (var i in data.headers) {
        row += '<th style=""><a href="#" class="sort"><span>' + data.headers[i] + '</span></a></th>';
    }
    row += '</tr>'
    $(row).appendTo('table:[id=results_table]');  //add to the dom
    row = '';
    for (var i in data.rows) {
        row += '<tr id="' + i + '">';
        for (var j=0; j <data.rows[i].length; j++){
            row += '<td>' + data.rows[i][j] + '</td>';
        }
        row += '</tr>';
    }


    $(row).appendTo('table:[id=results_table]'); //add to the dom
    //$(row).appendTo('table.data');
    }
    });
    });
    });
</script>

    <!--<script type="text/javascript" src="/static/lib/activation.js"></script>-->

{% endblock %}
{% block content %}
		    <!--<div id="tabs"></div>-->
{% load crispy_forms_tags %}
 <div id="activation_form">
   {% crispy activation_form activation_form.helper %}
  </div>
  <div id="results">
      <table id="results_table" border=1>

      </table>

  </div>
{% endblock %}
